var videoRegex = /^\s*```\s{0,4}video((.*[\r\n]+)+?)?\s*```$/im;

function processVideoBlockList(page) {

  var match;

  while ((match = videoRegex.exec(page.content))) {
    var rawBlock = match[0];
    var videoContent = match[1];
    page.content = page.content.replace(rawBlock, '<div class="video">' +
      videoContent + '</div>\n');
  }

  return page;
}

module.exports = {
  book: {
        assets: './assets',
        css: [
            'video-js.min.css'
        ],
        js: [
            'video.min.js'
        ]
  },
  hooks: {
    'page:before': processVideoBlockList,
    'page:change': processVideoBlockList
  }
};
